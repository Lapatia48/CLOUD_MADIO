================================================================================
                    CLOUD MADIO - GUIDE DE LANCEMENT
================================================================================

üìÅ PREREQUIS
-------------
- Docker Desktop install√© et d√©marr√©
- Se placer dans le dossier du projet:
  cd "L:\cours\le√ßons\S5\Rojo\CLOUD_MADIO"

================================================================================

üöÄ DEMARRAGE RAPIDE (Recommand√©)
---------------------------------

# Lancer tous les conteneurs (build + start)
docker compose up -d --build

================================================================================

üîÑ REINITIALISATION COMPLETE (Reset total)
-------------------------------------------

# √âtape 1: Arr√™ter et supprimer conteneurs + volumes (efface la BDD)
docker compose down -v

# √âtape 2: Reconstruire et relancer
docker compose up -d --build

================================================================================

üìã COMMANDES UTILES
--------------------

# Voir les conteneurs en cours
docker compose ps

# Voir les logs de tous les services
docker compose logs -f

# Voir les logs d'un service sp√©cifique
docker compose logs -f backend
docker compose logs -f frontend
docker compose logs -f db
docker compose logs -f mobile-ionic
docker compose logs -f tileserver

# Arr√™ter tous les conteneurs (sans supprimer les volumes)
docker compose down

# Red√©marrer un service sp√©cifique
docker compose restart backend
docker compose restart frontend

# Reconstruire un seul service
docker compose up -d --build backend
docker compose up -d --build frontend

================================================================================

üåê URLS D'ACCES
----------------

| Service         | URL                          | Description                |
|-----------------|------------------------------|----------------------------|
| Frontend Web    | http://localhost:3002        | Application React Manager  |
| Backend API     | http://localhost:8080        | API Spring Boot            |
| Mobile Ionic    | http://localhost:8100        | Preview mobile Ionic/Vue   |
| TileServer      | http://localhost:8085        | Serveur de tuiles carte    |
| PostgreSQL      | localhost:5432               | Base de donn√©es            |

================================================================================

üîë IDENTIFIANTS
----------------

PostgreSQL:
  - Host: localhost (ou db depuis Docker)
  - Port: 5432
  - Database: cloud_db
  - User: user_cloud
  - Password: password_cloud

Web Manager Login:
  - Email: manager@gmail.com
  - Password: manager

Firebase:
  - Project: cloud-s5-91071
  - Mode: Public (pas d'auth requise pour lecture)

================================================================================

üì± WORKFLOW COMPLET
--------------------

1. MOBILE: Cr√©er signalement
   - Ouvrir http://localhost:8100
   - Se connecter avec Firebase
   - Cr√©er un signalement avec photo + position GPS
   ‚Üí Envoy√© vers Firebase

2. WEB MANAGER: Sync et Traitement
   - Ouvrir http://localhost:3002
   - Login: admin@gmail.com / manager
   - Cliquer "Sync Firebase" (importe les signalements)
   - Cliquer sur un signalement pour d√©tails
   - Assigner: entreprise, avancement (0%/50%/100%), budget
   - Cliquer "Sync vers Firebase" pour pousser les changements

3. MOBILE: Voir les mises √† jour
   - Rafra√Æchir la carte
   - Les signalements montrent l'avancement et l'entreprise assign√©e

================================================================================

üêõ DEPANNAGE
-------------

# Si un conteneur ne d√©marre pas
docker compose logs <nom-service>

# Si la BDD est corrompue
docker compose down -v
docker compose up -d --build

# Si le build √©choue
docker compose build --no-cache

# V√©rifier l'espace disque Docker
docker system df

# Nettoyer les images/conteneurs non utilis√©s
docker system prune -a

================================================================================

üìä SERVICES ET PORTS
---------------------

+-------------------+     +-------------------+     +-------------------+
|   react_web       |     |   java_backend    |     |   postgres_db     |
|   (Frontend)      |---->|   (Spring Boot)   |---->|   (PostgreSQL)    |
|   :3002           |     |   :8080           |     |   :5432           |
+-------------------+     +-------------------+     +-------------------+
                                 |
                                 v
                    +------------------------+
                    |   Firebase Firestore   |
                    |   (cloud-s5-91071)     |
                    +------------------------+
                                 ^
                                 |
+-------------------+     +-------------------+
|   ionic_mobile    |     |   tileserver      |
|   (Mobile App)    |     |   (Map Tiles)     |
|   :8100           |     |   :8085           |
+-------------------+     +-------------------+

================================================================================




docker compose logs backend 2>&1 | Select-Object -Last 50

docker compose up -d --build
docker compose build --no-cache backend

docker compose build --no-cache backend frontend; docker compose up -d backend frontend


docker compose build --no-cache backend frontend mobile-ionic; docker compose up -d backend frontend mobile-ionic

docker compose build --no-cache mobile-ionic
docker compose up -d --force-recreate mobile-ionic